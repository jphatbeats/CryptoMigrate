{
  "openapi": "3.1.0",
  "info": {
    "title": "Titan Trading API",
    "description": "Comprehensive trading portfolio management with live exchange data from BingX, Kraken, and Blofin.",
    "version": "2.1.2-FIXED"
  },
  "servers": [
    {
      "url": "https://titan-trading-2-production.up.railway.app"
    }
  ],
  "paths": {
    "/health": {
      "get": {
        "description": "Health check endpoint to verify API connectivity",
        "operationId": "healthCheck",
        "responses": {
          "200": {
            "description": "API is healthy and responding",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "available_exchanges": { "type": "array", "items": { "type": "string" } },
                    "deployment_date": { "type": "string" },
                    "endpoints_fixed": { "type": "array", "items": { "type": "string" } },
                    "railway_ready": { "type": "boolean" },
                    "status": { "type": "string" },
                    "timestamp": { "type": "string" },
                    "undefined_vars_fixed": { "type": "boolean" },
                    "version": { "type": "string" }
                  },
                  "example": {
                    "available_exchanges": ["bingx","kraken","blofin"],
                    "deployment_date": "2025-08-10T13:07:00Z",
                    "endpoints_fixed": ["taapi_bulk","crypto_news_symbol","sentiment_analyze","social_momentum","undefined_variables"],
                    "railway_ready": true,
                    "status": "healthy",
                    "timestamp": "2025-08-10T18:18:54.147715",
                    "undefined_vars_fixed": true,
                    "version": "2.1.2-FIXED"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/": {
      "get": {
        "description": "API documentation and available endpoints",
        "operationId": "getApiDocumentation",
        "responses": {
          "200": {
            "description": "API documentation with all available endpoints",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "available_endpoints": { "type": "number" },
                    "available_exchanges": { "type": "array", "items": { "type": "string" } },
                    "exchange_specific_endpoints": { 
                      "type": "object",
                      "properties": {
                        "bingx_balance": { "type": "string" },
                        "bingx_klines": { "type": "string" },
                        "blofin_balance": { "type": "string" },
                        "kraken_balance": { "type": "string" }
                      }
                    },
                    "generic_endpoints": {
                      "type": "object",
                      "properties": {
                        "account": { "type": "string" },
                        "derivatives": { "type": "string" },
                        "exchange_status": { "type": "string" },
                        "health": { "type": "string" },
                        "portfolio": { "type": "string" },
                        "trading": { "type": "string" }
                      }
                    }
                  },
                  "example": {
                    "available_endpoints": 25,
                    "available_exchanges": ["bingx","kraken","blofin"],
                    "exchange_specific_endpoints": {
                      "bingx_balance": "/api/bingx/balance",
                      "bingx_klines": "/api/bingx/klines/{symbol}",
                      "blofin_balance": "/api/blofin/balance",
                      "kraken_balance": "/api/kraken/balance"
                    },
                    "generic_endpoints": {
                      "account": "/api/balance/{exchange}, /api/account-info/{exchange}, /api/transfer (POST)",
                      "derivatives": "/api/funding-rate/{exchange}/{symbol}, /api/leverage/{exchange}/{symbol} (POST)",
                      "exchange_status": "/exchanges/status",
                      "health": "/health",
                      "portfolio": "/api/positions/{exchange}, /api/positions/{exchange}",
                      "trading": "/api/order/{exchange} (POST), /api/orders/{exchange}, /api/order/{exchange}/{order_id} (DELETE)"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/positions/bingx": {
      "get": {
        "description": "FIXED: Get live BingX positions in ChatGPT-optimized format. Returns clean array of position objects with current P&L data.",
        "operationId": "getBingXPositions",
        "responses": {
          "200": {
            "description": "Live BingX positions array - verified compatible with ChatGPT parsing",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "symbol": { "type": "string", "description": "Trading pair", "example": "XRP/USDT:USDT" },
                      "side": { "type": "string", "description": "Position direction", "example": "long" },
                      "contracts": { "type": "number", "description": "Position size", "example": 824.0 },
                      "entryPrice": { "type": "number", "description": "Entry price in USDT", "example": 1.6341 },
                      "markPrice": { "type": "number", "description": "Current market price", "example": 3.1956 },
                      "unrealizedPnl": { "type": "number", "description": "LIVE P&L in USDT. Positive=profit, Negative=loss", "example": 1286.60 },
                      "realizedPnl": { "type": "number", "description": "Realized P&L", "example": -155.18 },
                      "leverage": { "type": "number", "description": "Position leverage", "example": 10.0 },
                      "marginMode": { "type": "string", "description": "Margin type", "example": "isolated" },
                      "liquidationPrice": { "type": "number", "description": "Liquidation price", "example": 1.6654 }
                    }
                  },
                  "example": [
                    {
                      "symbol": "FARTCOIN/USDT:USDT",
                      "side": "long",
                      "contracts": 231.093,
                      "entryPrice": 1.1099,
                      "markPrice": 1.0925,
                      "unrealizedPnl": -4.0142,
                      "realizedPnl": -0.297,
                      "leverage": 10.0,
                      "marginMode": "isolated",
                      "liquidationPrice": 1.0068
                    }
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/api/positions/kraken": {
      "get": {
        "description": "Get positions from Kraken exchange",
        "operationId": "getKrakenPositions",
        "responses": {
          "200": {
            "description": "Positions from Kraken (currently empty array)",
            "content": {
              "application/json": {
                "schema": { "type": "array", "items": { "type": "object" } },
                "example": []
              }
            }
          }
        }
      }
    },
    "/api/positions/blofin": {
      "get": {
        "description": "Get positions from Blofin exchange",
        "operationId": "getBlofinPositions",
        "responses": {
          "200": {
            "description": "Positions from Blofin (currently empty array)",
            "content": {
              "application/json": {
                "schema": { "type": "array", "items": { "type": "object" } },
                "example": []
              }
            }
          }
        }
      }
    },
    "/api/positions/all": {
      "get": {
        "description": "Get positions from all exchanges (returns error - use individual exchange endpoints)",
        "operationId": "getAllPositions",
        "responses": {
          "200": {
            "description": "Error response for all positions endpoint",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": { "type": "string" },
                    "exchange": { "type": "string" }
                  },
                  "example": {
                    "error": "Exchange all is not available. Available exchanges: ['bingx', 'kraken', 'blofin']",
                    "exchange": "all"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/live/all-exchanges": {
      "get": {
        "description": "Get live positions and orders from all exchanges",
        "operationId": "getAllExchangeData",
        "responses": {
          "200": {
            "description": "Comprehensive live exchange data",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "exchanges": {
                      "type": "object",
                      "properties": {
                        "bingx": {
                          "type": "object",
                          "properties": {
                            "status": { "type": "string" },
                            "positions": { "type": "array", "items": { "type": "object" } },
                            "orders": { "type": "array", "items": { "type": "object" } }
                          }
                        },
                        "blofin": {
                          "type": "object",
                          "properties": {
                            "status": { "type": "string" },
                            "positions": { "type": "array", "items": { "type": "object" } },
                            "orders": { "type": "array", "items": { "type": "object" } }
                          }
                        }
                      }
                    }
                  },
                  "example": {
                    "exchanges": {
                      "bingx": { "status": "success", "positions": [], "orders": [] },
                      "blofin": { "status": "success", "positions": [], "orders": [] }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/balance/bingx": {
      "get": {
        "description": "Get BingX account balances",
        "operationId": "getBingXBalance",
        "responses": {
          "200": {
            "description": "BingX account balances with free, used, and total amounts",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "BTC": {
                      "type": "object",
                      "properties": {
                        "free": { "type": "number" },
                        "total": { "type": "number" },
                        "used": { "type": "number" }
                      }
                    },
                    "ETH": {
                      "type": "object",
                      "properties": {
                        "free": { "type": "number" },
                        "total": { "type": "number" },
                        "used": { "type": "number" }
                      }
                    },
                    "USDT": {
                      "type": "object",
                      "properties": {
                        "free": { "type": "number" },
                        "total": { "type": "number" },
                        "used": { "type": "number" }
                      }
                    }
                  },
                  "additionalProperties": {
                    "type": "object",
                    "properties": {
                      "free": { "type": "number" },
                      "total": { "type": "number" },
                      "used": { "type": "number" }
                    }
                  },
                  "example": {
                    "BTC": { "free": 4.1e-07, "total": 4.1e-07, "used": 0.0 },
                    "ETH": { "free": 5e-09, "total": 5e-09, "used": 0.0 },
                    "USDT": { "free": 1866.82, "total": 2431.20, "used": 564.38 }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/balance/kraken": {
      "get": {
        "description": "Get Kraken account balances",
        "operationId": "getKrakenBalance",
        "responses": {
          "200": {
            "description": "Kraken account balances with free, used, and total amounts",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "AVAX": {
                      "type": "object",
                      "properties": {
                        "free": { "type": "number" },
                        "total": { "type": "number" },
                        "used": { "type": "number" }
                      }
                    }
                  },
                  "additionalProperties": {
                    "type": "object",
                    "properties": {
                      "free": { "type": "number" },
                      "total": { "type": "number" },
                      "used": { "type": "number" }
                    }
                  },
                  "example": {
                    "AVAX": { "free": 285.60, "total": 285.60, "used": 0.0 }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/balance/blofin": {
      "get": {
        "description": "Get Blofin account balances",
        "operationId": "getBlofinBalance",
        "responses": {
          "200": {
            "description": "Blofin account balances with free, used, and total amounts",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "USDT": {
                      "type": "object",
                      "properties": {
                        "free": { "type": "number" },
                        "total": { "type": "number" },
                        "used": { "type": "number" }
                      }
                    },
                    "datetime": { "type": "string" },
                    "free": {
                      "type": "object",
                      "properties": {
                        "USDT": { "type": "number" }
                      }
                    },
                    "info": { "type": "object", "additionalProperties": true },
                    "total": {
                      "type": "object", 
                      "properties": {
                        "USDT": { "type": "number" }
                      }
                    },
                    "used": {
                      "type": "object",
                      "properties": {
                        "USDT": { "type": "number" }
                      }
                    }
                  },
                  "example": {
                    "USDT": { "free": 0.0028, "total": 0.0028, "used": 0.0 }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/exchanges/status": {
      "get": {
        "description": "Get connection status for all exchanges",
        "operationId": "getExchangeStatus",
        "responses": {
          "200": {
            "description": "Exchange connection statuses and credentials verification",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "available_exchanges": { "type": "array", "items": { "type": "string" } },
                    "detailed_status": {
                      "type": "object",
                      "properties": {
                        "bingx": {
                          "type": "object",
                          "properties": {
                            "error": { "type": ["string", "null"] },
                            "has_credentials": { "type": "boolean" },
                            "status": { "type": "string" }
                          }
                        },
                        "blofin": {
                          "type": "object",
                          "properties": {
                            "error": { "type": ["string", "null"] },
                            "has_credentials": { "type": "boolean" },
                            "status": { "type": "string" }
                          }
                        },
                        "kraken": {
                          "type": "object",
                          "properties": {
                            "error": { "type": ["string", "null"] },
                            "has_credentials": { "type": "boolean" },
                            "status": { "type": "string" }
                          }
                        }
                      }
                    },
                    "timestamp": { "type": "string" }
                  },
                  "example": {
                    "available_exchanges": ["bingx", "kraken", "blofin"],
                    "detailed_status": {
                      "bingx": { "error": null, "has_credentials": true, "status": "connected" },
                      "blofin": { "error": null, "has_credentials": true, "status": "connected" },
                      "kraken": { "error": null, "has_credentials": false, "status": "public_only" }
                    },
                    "timestamp": "2025-08-10T18:55:44.004679"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/orders/bingx": {
      "get": {
        "description": "Get open orders from BingX exchange",
        "operationId": "getBingXOrders",
        "responses": {
          "200": {
            "description": "BingX open orders (currently empty)",
            "content": {
              "application/json": {
                "schema": { "type": "array", "items": { "type": "object" } },
                "example": []
              }
            }
          }
        }
      }
    },
    "/api/orders/kraken": {
      "get": {
        "description": "Get open orders from Kraken exchange",
        "operationId": "getKrakenOrders",
        "responses": {
          "200": {
            "description": "Kraken open orders (currently empty)",
            "content": {
              "application/json": {
                "schema": { "type": "array", "items": { "type": "object" } },
                "example": []
              }
            }
          }
        }
      }
    },
    "/api/orders/blofin": {
      "get": {
        "description": "Get open orders from Blofin exchange",
        "operationId": "getBlofinOrders",
        "responses": {
          "200": {
            "description": "Blofin open orders (currently empty)",
            "content": {
              "application/json": {
                "schema": { "type": "array", "items": { "type": "object" } },
                "example": []
              }
            }
          }
        }
      }
    },
    "/api/live/account-balances": {
      "get": {
        "description": "Get account balances from all exchanges",
        "operationId": "getAllAccountBalances",
        "responses": {
          "200": {
            "description": "Comprehensive account balances from all exchanges",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "balances": {
                      "type": "object",
                      "properties": {
                        "bingx": {
                          "type": "object",
                          "properties": {
                            "data": { "type": "object", "additionalProperties": true },
                            "status": { "type": "string" }
                          }
                        },
                        "blofin": {
                          "type": "object",
                          "properties": {
                            "data": { "type": "object", "additionalProperties": true },
                            "status": { "type": "string" }
                          }
                        }
                      }
                    },
                    "timestamp": { "type": "string" }
                  },
                  "example": {
                    "balances": {
                      "bingx": { "status": "success", "data": { "USDT": { "free": 1866.82, "total": 2431.20, "used": 564.38 } } },
                      "blofin": { "status": "success", "data": { "USDT": { "free": 0.0028, "total": 0.0028, "used": 0.0 } } }
                    },
                    "timestamp": "2025-08-10T18:55:43.536639"
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}